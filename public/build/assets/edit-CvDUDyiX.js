import{W as k,r as p,j as s}from"./app-CcCqTZT3.js";import{H as w,N as E}from"./Nav-DXO1xuTL.js";import"./index-DXmVpITn.js";const O=({user:h,user_type:f,role:t,permissions:c,notif:j})=>{console.log("Role:",t),console.log("Permissions:",c);const{data:l,setData:x,post:g,errors:m}=k({role_name:t?t.name:"",permissions:t?t.permissions.map(e=>e.id):[]}),[v,N]=p.useState({});p.useEffect(()=>{c&&b(c)},[c]);const b=e=>{if(e&&e.length>0){const r=e.reduce((n,i)=>{const d=i.name.split("_"),u=d[0],o=d.slice(1).join("_");return n[o]||(n[o]=[]),n[o].push({id:i.id,action:u}),n},{}),a=Object.keys(r).reduce((n,i)=>(n[i]=r[i].sort((d,u)=>{const o=["view","create","edit","delete"];return o.indexOf(d.action)-o.indexOf(u.action)}),n),{});console.log("Sorted Grouped Permissions:",a),N(a)}},_=e=>{x("permissions",l.permissions.includes(e)?l.permissions.filter(r=>r!==e):[...l.permissions,e])},C=e=>{x(e.target.name,e.target.value)},P=e=>{e.preventDefault(),g(`/roles-permission-update/${t.id}`,{onSuccess:()=>{console.log("Role updated successfully!")},onError:()=>{console.log("Error updating role.")}})};return!t||!c?s.jsx("div",{children:"Loading..."}):s.jsxs("div",{className:"w-[85.2%] ml-[12rem]",children:[s.jsx(w,{user:h,notif:j}),s.jsx(E,{user_type:f}),s.jsxs("form",{onSubmit:P,className:"px-[9rem]",children:[s.jsx("div",{className:"form mt-9",children:s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"role_name",children:"Role Name"}),s.jsx("input",{type:"text",name:"role_name",value:l.role_name,onChange:C,className:`form-control ${m.role_name?"is-invalid":" w-full"}`,required:!0}),m.role_name&&s.jsx("div",{className:"invalid-feedback",children:m.role_name})]})}),s.jsx("div",{className:"form-group",children:Object.entries(v).map(([e,r])=>s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("h3",{className:"w-[7rem]",children:e.charAt(0).toUpperCase()+e.slice(1)}),s.jsx("div",{style:{marginLeft:"20px"},className:"flex space-x-[4rem]",children:r.map(a=>s.jsxs("div",{className:"space-x-2",children:[s.jsx("input",{type:"checkbox",name:"permissions[]",value:a.id,checked:l.permissions.includes(a.id),onChange:()=>_(a.id)}),s.jsx("label",{children:a.action.charAt(0).toUpperCase()+a.action.slice(1)})]},a.id))})]},e))}),s.jsx("button",{type:"submit",className:"p-2 mt-4 text-white rounded btn bg-slate-900",children:"Update Role"})]})]})};export{O as default};
